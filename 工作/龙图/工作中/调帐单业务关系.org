#+BEGIN_SRC sql
SELECT GLOBAL_MULTYEAR_CZ.SECU_F_GLOBAL_SETPARM('', '1500', '2017', '') FROM DUAL;

--调帐单
/*
153	34BC577B40883C5A49645DEAFD017EF4
246	9EA0042A7AA61AA32DDC4A375366F87A
*/
SELECT  t.wfstatus, t.agencyguid,t.BILLCODE,  t.amt, t.REMARK, t.CREATEDATE, t.guid   FROM PAY_T_AJACCOUNT t;

--调帐单明细
SELECT t.amt, t.ADJUSTAMT, t.ADJUSTGUID, t.guid, t.billcode FROM pay_t_request t WHERE t.ADJUSTGUID = '9EA0042A7AA61AA32DDC4A375366F87A';

--调帐单明细 一正一负
select t.amt, t.ADJUSTAMT, t.ADJUSTGUID, t.guid, t.billcode from pay_t_request t where t.amt > 0 and t.ADJUSTGUID = 'E0928E445655AB1837892AED1E199CB5';

-- > 0 adjustamt xx  1CB671FA099082497008E23DB6629549可执行计划 --> 	28175BCD05875B247DEA8FB3E9DF9D6B确认支付
select t.amt, t.fromctrlid, t.TOCTRLID, t.BCTYPEID, t.CREDITACCOUNT, t.DEBITACCOUNT from pay_t_requestsub t where t.MAINGUID = 'EC315534A3AED713A9216B1B3F90AEA6';

-- < 0
select t.amt, t.ADJUSTAMT, t.ADJUSTGUID, t.guid, t.billcode, t.SOURCEGUID from pay_t_request t where t.amt < 0 and t.ADJUSTGUID = 'E880EEB1944742E160841E60F8BA437D';

--28175BCD05875B247DEA8FB3E9DF9D6B  --> 	1CB671FA099082497008E23DB6629549
SELECT t.amt, t.fromctrlid, t.TOCTRLID, t.BCTYPEID,  t.CREDITACCOUNT, t.DEBITACCOUNT,t.SOURCEGUID FROM pay_t_requestsub t WHERE t.MAINGUID = 'AF03665DE194BC6A31185CCB78BB2A65';

--原申请
--
select t.amt, t.ADJUSTAMT from pay_t_request t where t.guid = '8FBFED52C65AB2DA17DB59EDDE7E304C';


--凭证 (退款的保留adjustguid)

-- < 0 (关联关系还需要确定)
SELECT t.amt, t.ADJUSTAMT, t.CREATEDATE, t.REALCREATER, t.SOURCEGUID, t.guid FROM PAY_T_PAYMAIN t WHERE t.ADJUSTGUID = '34BC577B40883C5A49645DEAFD017EF4';

SELECT t.guid, t.amt, t.ADJUSTAMT, t.BCTYPEID, t.CREDITACCOUNT, t.DEBITACCOUNT, t.SOURCEGUID FROM pay_t_paysub t WHERE t.MAINGUID = 'ABF68EEE13DD8DBD5EB92B66C5862B2A';

SELECT t.amt, t.ADJUSTAMT FROM pay_t_paymain t WHERE t.guid = '59C96F7F08A0FB210CA189A6A4744A4F';
select * from pay_t_paysub t where t.guid = '6A9C230C6C0604C0E52351659C91C76D';
SELECT t.SOURCEGUID, t.* FROM PAY_T_PAYmain t  ;
SELECT t.amt, t.ADJUSTAMT, t.MAINGUID FROM pay_t_paysub t WHERE t.MAINGUID = '';

-- > 0
SELECT t.mainguid, t.amt, t.ADJUSTAMT FROM pay_t_paysub t WHERE t.REQUESTGUID = '0604670B0B8360CF8AED3C87A22CF126';

select t.amt, t.ADJUSTAMT, t.GUID from pay_t_paymain t where t.guid = '26757B24131E10F2B9D52B5AFCDDCA55';

select t.amt, t.ADJUSTAMT from pay_t_paymain t where t.guid = '59C96F7F08A0FB210CA189A6A4744A4F';

--6A9C230C6C0604C0E52351659C91C76D
--52FA48DF65CA3DC1424B36AE5CA2E93C
select t.REQUESTGUID from pay_t_paysub t where t.MAINGUID = '59C96F7F08A0FB210CA189A6A4744A4F';

select * from fasp_t_pubaccount t where t.guid = '1CB671FA099082497008E23DB6629549';

--59C96F7F08A0FB210CA189A6A4744A4F
--52FA48DF65CA3DC1424B36AE5CA2E93C
SELECT t.MAINGUID FROM pay_t_paysub t WHERE t.ADJUSTAMT = 246;
SELECT t.amt, t.ADJUSTAMT FROM PAY_T_PAYMAIN t WHERE t.guid = '52FA48DF65CA3DC1424B36AE5CA2E93C';
select * from PAY_T_PAYMAIN t where t.ADJUSTAMT = 399;

--正向申请 5
SELECT * FROM pay_t_requestsub t3 WHERE t3.amt > 0 AND t3.MAINGUID IN(SELECT t.guid FROM pay_t_request t WHERE t.ADJUSTGUID IN (SELECT t2.guid FROM PAY_T_AJACCOUNT t2));
--正向凭证
SELECT * FROM pay_t_paysub t4 WHERE t4.REQUESTGUID IN (SELECT t3.MAINGUID FROM pay_t_requestsub t3 WHERE t3.amt > 0 AND t3.MAINGUID IN(SELECT t.guid FROM pay_t_request t WHERE t.ADJUSTGUID IN (SELECT t2.guid FROM PAY_T_AJACCOUNT t2)));
--逆向申请 5
SELECT * FROM pay_t_requestsub t3 WHERE t3.amt < 0 AND t3.MAINGUID IN(SELECT t.guid FROM pay_t_request t WHERE t.ADJUSTGUID IN (SELECT t2.guid FROM PAY_T_AJACCOUNT t2));
--逆向凭证 5
SELECT * FROM pay_t_paysub t3 WHERE t3.AMT < 0 and t3.MAINGUID IN( select t.guid from PAY_T_PAYMAIN t where t.ADJUSTGUID in (select t2.guid from PAY_T_AJACCOUNT t2 ));
#+END_SRC
